class(df.imputed$pclass)
class(df.imputed$age)
class(df.imputed$parch)
class(df.imputed$sex)
class(df.imputed$embarked)
class(df.test$pclass)
class(df.test$age)
class(df.test$parch)
class(df.test$sex)
class(df.test$embarked)
df.predict <- predict(m.rF, test.subset)
help(package="Hmisc")
head(df.test)
test.col <- c("pclass","age","parch","sex","embarked")
test.col <- c("pclass","age","parch","sex","embarked")
test.subset <- lapply(test.col, function(x) impute(x))
class(test.subset)
subset.list <- lapply(test.col, function(x) impute(x))
df.subset <- do.call("rbind", subset.list)
head(df.subset)
subset.list <- lapply(test.col, function(x) impute(x))
class(subset.list[[1]])
head(subset.list[[1]])
subset.list <- lapply(test.col, function(x) impute(df.test$x))
test.imputed <- impute(df.test)
head(test.imputed)
test.imputed
test.imputed <- impute(df.test)
test.imputed
df.test
test.imputed$pclass <- impute(test.imputed$pclass)
head(test.imputed)
?impute
is.imputed(test.imputed)
q()
setwd("~/Documents/PROJECTS/contests/Titanic/")
source("~/Documents/WORK/source_functions.R")
library(ggplot2)
# library(e1071)
library(randomForest)
library(Hmisc)
df.train <- read.csv("DATA/train.csv", na.strings="NA", header=TRUE)
df.train$survived <- as.factor(df.train$survived)
df.test <- read.csv("DATA/test.csv", na.strings="NA", header=TRUE)
############################################################################
## GLM
############################################################################
m <- glm(survived ~ pclass+age+sibsp+parch+sex, df.train, family="binomial")
df.predict <- predict(m, df.test, type="response")
# df.predict <- round(df.predict, digits=0)
df.predict <- ifelse(is.na(df.predict), 0, df.predict)
write.csv(df.predict, file="predictions.csv", row.names=FALSE, col.names=NA)
############################################################################
## Random Forest
############################################################################
df.imputed <- rfImpute(survived ~ pclass+age+parch+sex+embarked, df.train)
m.rF <- randomForest(survived ~ ., df.imputed)
test.col <- c("pclass","age","parch","sex","embarked")
test.imputed <- df.test
test.imputed$pclas <- impute(test.imputed$pclass)
head(test.imputed)
test.imputed <- impute(df.test)
head(test.imputed)
test.imputed <- df.test
test.imputed <- subset(df.test, select = test.col)
head(test.imputed)
test.imputed <- impute(test.imputed)
test.imputed <- impute(subset(df.test, select = test.col))
test.imputed <- subset(df.test, select = test.col)
test.imputed$pclass <- impute(test.imputed$pclass)
head(test.imputed)
test.imputed <- subset(df.test, select = test.col)
test.imputed$pclass <- impute(test.imputed$pclass)
test.imputed$age <- impute(test.imputed$age)
test.imputed$parch <- impute(test.imputed$parch)
test.imputed$sex <- impute(test.imputed$sex)
test.imputed$embarked <- impute(test.imputed$embarked)
head(test.imputed)
df.predict <- predict(m.rF, test.imputed)
test.imputed <- df.test
test.imputed$pclass <- impute(test.imputed$pclass)
test.imputed$age <- impute(test.imputed$age)
test.imputed$parch <- impute(test.imputed$parch)
test.imputed$sex <- impute(test.imputed$sex)
test.imputed$embarked <- impute(test.imputed$embarked)
df.predict <- predict(m.rF, test.imputed)
head(test.imputed)
head(df.train)
m.rF <- randomForest(survived ~ pclass+age+parch+sex+embarked, df.imputed)
test.col <- c("pclass","age","parch","sex","embarked")
# test.imputed <- subset(df.test, select = test.col)
test.imputed <- df.test
test.imputed$pclass <- impute(test.imputed$pclass)
test.imputed$age <- impute(test.imputed$age)
test.imputed$parch <- impute(test.imputed$parch)
test.imputed$sex <- impute(test.imputed$sex)
test.imputed$embarked <- impute(test.imputed$embarked)
df.predict <- predict(m.rF, test.imputed)
df.imputed <- impute(df.train)
head(df.train)
df.imputed <- rfImpute(survived ~ pclass+age+parch+sex+embarked, df.train)
head(df.imputed)
m.rF <- randomForest(survived ~ ., df.imputed)
head(m.rF)
df.predict <- predict(m.rF, test.imputed)
df.predict <- predict(m.rF, df.test)
test.imputed <- rFImpute(df.test)
test.imputed <- rfImpute(df.test)
?predict.randomForest
df.predict <- predict(m.rF, df.test, predict.all=TRUE)
df.predict <- predict(m.rF, df.test, predict.all=FALSE)
names(df.imputed)
test.subset <- subset(df.test, select = test.col)
head(test.subset)
names(test.subset)
names(df.impted)
names(df.imputed)
df.predict <- predict(m.rF, df.test, predict.all=FALSE)
setwd("~/Documents/PROJECTS/contests/Titanic/")
source("~/Documents/WORK/source_functions.R")
library(ggplot2)
# library(e1071)
library(randomForest)
library(Hmisc)
df.train <- read.csv("DATA/train.csv", na.strings="NA", header=TRUE)
df.train$survived <- as.factor(df.train$survived)
df.test <- read.csv("DATA/test.csv", na.strings="NA", header=TRUE)
############################################################################
## GLM
############################################################################
m <- glm(survived ~ pclass+age+sibsp+parch+sex, df.train, family="binomial")
df.predict <- predict(m, df.test, type="response")
# df.predict <- round(df.predict, digits=0)
df.predict <- ifelse(is.na(df.predict), 0, df.predict)
head(df.train)
head(df.test)
df.predict <- predict(m.rF, test.subset, predict.all=FALSE)
df.predict <- predict(m.rF, test.subset)
df.imputed <- impute(df.train)
q()
setwd("~/Documents/PROJECTS/contests/Titanic/")
source("~/Documents/WORK/source_functions.R")
library(ggplot2)
# library(e1071)
library(randomForest)
library(Hmisc)
df.train <- read.csv("DATA/train.csv", na.strings="NA", header=TRUE)
df.train$survived <- as.factor(df.train$survived)
df.test <- read.csv("DATA/test.csv", na.strings="NA", header=TRUE)
df.imputed <- impute(df.train)
df.imputed <- rfImpute(survived ~ pclass+age+parch+sex+embarked, df.train)
?randomForest
m.rF <- randomForest(survived ~ pclass+age+parch+sex+embarked, df.test, na.action=na.fail)
m.rF <- randomForest(survived ~ pclass+age+parch+sex+embarked, df.train, na.action=na.fail)
m.rF <- randomForest(survived ~ pclass+age+parch+sex+embarked, df.train, na.action=na.fail)
m.rF <- randomForest(survived ~ pclass+age+parch+sex+embarked, df.train, na.action=na.fail)
m.rF <- randomForest(survived ~ pclass+age+parch+sex+embarked, df.train, na.action=na.roughfix)
df.predict <- predict(m.rF, test.subset)
df.predict <- predict(m.rF, df.test)
head(df.train)
names(df.train)
names(df.test)
df.predict <- predict(m.rF, df.test, na.action=na.roughfix)
head(df.test)
test.cols <- c("pclass","age","parch","sex","embarked")
train.subset <- subset(df.train, select = c("survived", test.cols))
head(train.subset)
test.subset <- subset(df.test, select = test.cols)
m.rF <- randomForest(survived ~ ., train.subset, na.action=na.roughfix)
df.predict <- predict(m.rF, test.subset)
head(df.test)
head(test.subset)
test.subset <- impute(subset(df.test, select = test.cols))
?na.roughfix
test.subset <- na.roughfix(subset(df.test, select = test.cols))
head(test.subset)
df.predict <- predict(m.rF, test.subset)
View(test.subset)
head(train.subset)
class(test.subset$age)
class(train.subset$age)
class(train.subset$parch)
class(test.subset$parch)
class(train.subset$pclass)
class(test.subset$pclass)
?na.omit
test.subset <- na.omit(subset(df.test, select = test.cols))
df.predict <- predict(m.rF, test.subset)
m.rF <- randomForest(survived ~ ., train.subset, na.action=na.roughfix)
df.predict <- predict(m.rF, test.subset)
m.rF <- randomForest(survived ~ ., train.subset, na.action=na.omit)
df.predict <- predict(m.rF, test.subset)
?predict.randomForest
help(package=randomForest)
plot.randomForest(m.rF)
plot(m.rF)
q()
setwd("~/Documents/PROJECTS/contests/Titanic/")
source("~/Documents/WORK/source_functions.R")
library(ggplot2)
# library(e1071)
# library(randomForest)
library(rpart)
library(Hmisc)
df.train <- read.csv("DATA/train.csv", na.strings="NA", header=TRUE)
df.train$survived <- as.factor(df.train$survived)
df.test <- read.csv("DATA/test.csv", na.strings="NA", header=TRUE)
############################################################################
## GLM
############################################################################
m <- glm(survived ~ pclass+age+sibsp+parch+sex, df.train, family="binomial")
df.predict <- predict(m, df.test, type="response")
# df.predict <- round(df.predict, digits=0)
df.predict <- ifelse(is.na(df.predict), 0, df.predict)
# write.csv(df.predict, file="predictions.csv", row.names=FALSE, col.names=NA)
############################################################################
## Tree Based Model
############################################################################
?rpart
m.tree <- rpart(survived ~ pclass+age+parch+sex+embarked, df.train)
m.tree
library(randomForest)
?rfImpute
df.imputed <- rfImpute(survived ~ pclass+age+parch+sex+embarked, df.train)
m.tree <- rpart(survived ~ ., df.imputed)
m.tree
df.predict <- predict(m.tree, df.test)
head(df.predict)
df.predict <- predict(m.tree, df.test)$1
df.predict <- predict(m.tree, df.test)$"1"
df.predict <- predict(m.tree, df.test)
df.predict <- as.data.frame(predict(m.tree, df.test))
head(df.predict)
df.predict <- as.data.frame(predict(m.tree, df.test))$"1"
head(df.predict)
write.csv(df.predict="predictions_tree.csv")
write.csv(df.predict, file="predictions_tree.csv")
write.csv(df.predict, file="predictions_tree.csv", row.names=FALSE)
write.csv(df.predict, file="predictions_tree.csv", row.names=FALSE, col.names=FALSE)
df.predict <- as.data.frame(predict(m.tree, df.test, type="response"))
df.predict <- as.data.frame(predict(m.tree, df.test, type="class"))
head(df.predict)
table(df.predict)
View(df.predict)
write.csv(df.predict, file="predictions_tree.csv", row.names=FALSE)
head(df.predict)
class(df.predict$predict(m.tree, df.test, type = "class"))
class(df.predict$"predict(m.tree, df.test, type = "class")")
############################################################################
head(df.predict)
names(df.predict) <- "x"
class(df.predict$x)
df.predict$x <- as.integer(df.predict$x)
head(df.predict)
table(df.predict)
write.csv(df.predict, file="predictions_tree.csv", row.names=FALSE)
df.predict <- predict(m.tree, df.test, type="class")
head(df.predict)
df.predict <- as.numeric(df.predict)
head(df.predict)
table(df.predict)
df.predict <- as.integer(df.predict) - 1
table(df.predict)
write.csv(df.predict, file="predictions_tree.csv", row.names=FALSE)
q()
setwd("~/Documents/PROJECTS/contests/Titanic/")
source("~/Documents/WORK/source_functions.R")
library(ggplot2)
# library(e1071)
library(randomForest)
library(rpart)
library(Hmisc)
df.train <- read.csv("DATA/train.csv", na.strings="NA", header=TRUE)
df.train$survived <- as.factor(df.train$survived)
df.test <- read.csv("DATA/test.csv", na.strings="NA", header=TRUE)
############################################################################
## GLM
############################################################################
m <- glm(survived ~ pclass+age+sibsp+parch+sex, df.train, family="binomial")
df.predict <- predict(m, df.test, type="response")
# df.predict <- round(df.predict, digits=0)
df.predict <- ifelse(is.na(df.predict), 0, df.predict)
# write.csv(df.predict, file="predictions.csv", row.names=FALSE, col.names=NA)
############################################################################
## Tree Based Model
############################################################################
df.imputed <- rfImpute(survived ~ pclass+age+parch+sex+embarked, df.train)
m.tree <- rpart(survived ~ ., df.imputed)
df.predict <- predict(m.tree, df.test, type="class")
df.predict <- as.integer(df.predict) - 1
write.csv(df.predict, file="predictions_tree.csv", row.names=FALSE)
############################################################################
## Neural Network
############################################################################
head(df.imputed)
x.nn <- subset(df.imputed, select = c("pclass","age","parch","sex","embarked"))
y.nn <- subset(df.imputed, select = "survived")
?nnet
library(nnet)
?nnet
m.nn <- nnet(survived ~ pclass+age+parch+sex+embarked, df.imputed)
6  2/3
6  *2/3
m.nn <- nnet(survived ~ pclass+age+parch+sex+embarked, df.imputed, size=4)
?predict.nnet
df.predict <- predict(m.nn, df.test)
head(df.predict)
df.predict <- predict(m.nn, df.test, type="class")
head(df.predict)
View(df.predict)
library(package=nnet)
help(package=nnet)
?impute
head(df.test)
View(df.test)
table(df.test$pclass)
107+93+218
table(df.test$sex)
table(df.test$age)
table(df.test$sibsp)
table(df.test$parch)
table(df.test$embarked)
head(df.predict)
subset(df.predict, subset = is.na(df.predict))
subset(df.predict, subset = is.na(df.predict) == TRUE)
View(df.predict)
names(df.predict)
names(df.test)
head(df.test$ticket)
head(df.test$fare)
class(df.test$fare)
df.test$fare[1:20,]
df.test$fare[1:20]
df.test$fare[1:50]
is.na(df.test$fare[1:50])
is.na(df.test$fare[1:100])
View(df.test)
df.test$age <- impute(df.test$age, fun=median)
df.predict <- predict(m.nn, df.test, type="class")
View(df.predict)
table(df.predict)
df.imputed <- rfImpute(survived ~ pclass+age+parch+sex+embarked, df.train)
m.tree <- rpart(survived ~ ., df.imputed)
df.predict <- predict(m.tree, df.test, type="class")
df.predict <- as.integer(df.predict) - 1
table(df.predict)
x.nn <- subset(df.imputed, select = c("pclass","age","parch","sex","embarked"))
y.nn <- subset(df.imputed, select = "survived")
m.nn <- nnet(survived ~ pclass+age+parch+sex+embarked, df.imputed, size=4)
df.test$age <- impute(df.test$age, fun=median)
df.predict <- predict(m.nn, df.test, type="class")
table(df.predict)
x.nn <- subset(df.imputed, select = c("pclass","age","parch","sex","embarked"))
y.nn <- subset(df.imputed, select = "survived")
m.nn <- nnet(survived ~ pclass+age+parch+sex+embarked, df.imputed, size=4)
df.test$age <- impute(df.test$age, fun=median)
df.predict <- predict(m.nn, df.test, type="class")
table(df.predict)
x.nn <- subset(df.imputed, select = c("pclass","age","parch","sex","embarked"))
y.nn <- subset(df.imputed, select = "survived")
m.nn <- nnet(survived ~ pclass+age+parch+sex+embarked, df.imputed, size=4)
df.test$age <- impute(df.test$age, fun=median)
df.predict <- predict(m.nn, df.test, type="class")
table(df.predict)
x.nn <- subset(df.imputed, select = c("pclass","age","parch","sex","embarked"))
y.nn <- subset(df.imputed, select = "survived")
m.nn <- nnet(survived ~ pclass+age+parch+sex+embarked, df.imputed, size=4)
df.test$age <- impute(df.test$age, fun=median)
df.predict <- predict(m.nn, df.test, type="class")
table(df.predict)
x.nn <- subset(df.imputed, select = c("pclass","age","parch","sex","embarked"))
y.nn <- subset(df.imputed, select = "survived")
m.nn <- nnet(survived ~ pclass+age+parch+sex+embarked, df.imputed, size=4)
df.test$age <- impute(df.test$age, fun=median)
df.predict <- predict(m.nn, df.test, type="class")
table(df.predict)
x.nn <- subset(df.imputed, select = c("pclass","age","parch","sex","embarked"))
y.nn <- subset(df.imputed, select = "survived")
m.nn <- nnet(survived ~ pclass+age+parch+sex+embarked, df.imputed, size=4)
df.test$age <- impute(df.test$age, fun=median)
df.predict <- predict(m.nn, df.test, type="class")
table(df.predict)
x.nn <- subset(df.imputed, select = c("pclass","age","parch","sex","embarked"))
y.nn <- subset(df.imputed, select = "survived")
m.nn <- nnet(survived ~ pclass+age+parch+sex+embarked, df.imputed, size=4)
df.test$age <- impute(df.test$age, fun=median)
df.predict <- predict(m.nn, df.test, type="class")
table(df.predict)
x.nn <- subset(df.imputed, select = c("pclass","age","parch","sex","embarked"))
y.nn <- subset(df.imputed, select = "survived")
m.nn <- nnet(survived ~ pclass+age+parch+sex+embarked, df.imputed, size=4)
df.test$age <- impute(df.test$age, fun=median)
df.predict <- predict(m.nn, df.test, type="class")
table(df.predict)
x.nn <- subset(df.imputed, select = c("pclass","age","parch","sex","embarked"))
y.nn <- subset(df.imputed, select = "survived")
m.nn <- nnet(survived ~ pclass+age+parch+sex+embarked, df.imputed, size=4)
df.test$age <- impute(df.test$age, fun=median)
df.predict <- predict(m.nn, df.test, type="class")
table(df.predict)
x.nn <- subset(df.imputed, select = c("pclass","age","parch","sex","embarked"))
y.nn <- subset(df.imputed, select = "survived")
m.nn <- nnet(survived ~ pclass+age+parch+sex+embarked, df.imputed, size=4)
df.test$age <- impute(df.test$age, fun=median)
df.predict <- predict(m.nn, df.test, type="class")
table(df.predict)
x.nn <- subset(df.imputed, select = c("pclass","age","parch","sex","embarked"))
y.nn <- subset(df.imputed, select = "survived")
m.nn <- nnet(survived ~ pclass+age+parch+sex+embarked, df.imputed, size=4)
df.test$age <- impute(df.test$age, fun=median)
df.predict <- predict(m.nn, df.test, type="class")
table(df.predict)
x.nn <- subset(df.imputed, select = c("pclass","age","parch","sex","embarked"))
y.nn <- subset(df.imputed, select = "survived")
m.nn <- nnet(survived ~ pclass+age+parch+sex+embarked, df.imputed, size=4)
df.test$age <- impute(df.test$age, fun=median)
df.predict <- predict(m.nn, df.test, type="class")
table(df.predict)
x.nn <- subset(df.imputed, select = c("pclass","age","parch","sex","embarked"))
y.nn <- subset(df.imputed, select = "survived")
m.nn <- nnet(survived ~ pclass+age+parch+sex+embarked, df.imputed, size=4)
df.test$age <- impute(df.test$age, fun=median)
df.predict <- predict(m.nn, df.test, type="class")
table(df.predict)
x.nn <- subset(df.imputed, select = c("pclass","age","parch","sex","embarked"))
y.nn <- subset(df.imputed, select = "survived")
m.nn <- nnet(survived ~ pclass+age+parch+sex+embarked, df.imputed, size=4)
df.test$age <- impute(df.test$age, fun=median)
df.predict <- predict(m.nn, df.test, type="class")
table(df.predict)
x.nn <- subset(df.imputed, select = c("pclass","age","parch","sex","embarked"))
y.nn <- subset(df.imputed, select = "survived")
m.nn <- nnet(survived ~ pclass+age+parch+sex+embarked, df.imputed, size=4)
df.test$age <- impute(df.test$age, fun=median)
df.predict <- predict(m.nn, df.test, type="class")
table(df.predict)
x.nn <- subset(df.imputed, select = c("pclass","age","parch","sex","embarked"))
y.nn <- subset(df.imputed, select = "survived")
m.nn <- nnet(survived ~ pclass+age+parch+sex+embarked, df.imputed, size=4)
df.test$age <- impute(df.test$age, fun=median)
df.predict <- predict(m.nn, df.test, type="class")
table(df.predict)
x.nn <- subset(df.imputed, select = c("pclass","age","parch","sex","embarked"))
y.nn <- subset(df.imputed, select = "survived")
m.nn <- nnet(survived ~ pclass+age+parch+sex+embarked, df.imputed, size=4)
df.test$age <- impute(df.test$age, fun=median)
df.predict <- predict(m.nn, df.test, type="class")
table(df.predict)
x.nn <- subset(df.imputed, select = c("pclass","age","parch","sex","embarked"))
y.nn <- subset(df.imputed, select = "survived")
m.nn <- nnet(survived ~ pclass+age+parch+sex+embarked, df.imputed, size=4)
df.test$age <- impute(df.test$age, fun=median)
df.predict <- predict(m.nn, df.test, type="class")
table(df.predict)
x.nn <- subset(df.imputed, select = c("pclass","age","parch","sex","embarked"))
y.nn <- subset(df.imputed, select = "survived")
m.nn <- nnet(survived ~ pclass+age+parch+sex+embarked, df.imputed, size=4)
df.test$age <- impute(df.test$age, fun=median)
df.predict <- predict(m.nn, df.test, type="class")
table(df.predict)
df.imputed <- rfImpute(survived ~ pclass+age+parch+sex+embarked, df.train)
m.tree <- rpart(survived ~ ., df.imputed)
df.predict <- predict(m.tree, df.test, type="class")
df.predict <- as.integer(df.predict) - 1
# write.csv(df.predict, file="predictions_tree.csv", row.names=FALSE)
table(df.predict)
x.nn <- subset(df.imputed, select = c("pclass","age","parch","sex","embarked"))
y.nn <- subset(df.imputed, select = "survived")
m.nn <- nnet(survived ~ pclass+age+parch+sex+embarked, df.imputed, size=4)
df.test$age <- impute(df.test$age, fun=median)
df.predict <- predict(m.nn, df.test, type="class")
x.nn <- subset(df.imputed, select = c("pclass","age","parch","sex","embarked"))
y.nn <- subset(df.imputed, select = "survived")
m.nn <- nnet(survived ~ pclass+age+parch+sex+embarked, df.imputed, size=4)
df.test$age <- impute(df.test$age, fun=median)
df.predict <- predict(m.nn, df.test, type="class")
table(df.predict)
x.nn <- subset(df.imputed, select = c("pclass","age","parch","sex","embarked"))
y.nn <- subset(df.imputed, select = "survived")
m.nn <- nnet(survived ~ pclass+age+parch+sex+embarked, df.imputed, size=4)
df.test$age <- impute(df.test$age, fun=median)
df.predict <- predict(m.nn, df.test, type="class")
table(df.predict)
x.nn <- subset(df.imputed, select = c("pclass","age","parch","sex","embarked"))
y.nn <- subset(df.imputed, select = "survived")
m.nn <- nnet(survived ~ pclass+age+parch+sex+embarked, df.imputed, size=4)
df.test$age <- impute(df.test$age, fun=median)
df.predict <- predict(m.nn, df.test, type="class")
table(df.predict)
x.nn <- subset(df.imputed, select = c("pclass","age","parch","sex","embarked"))
y.nn <- subset(df.imputed, select = "survived")
m.nn <- nnet(survived ~ pclass+age+parch+sex+embarked, df.imputed, size=4)
df.test$age <- impute(df.test$age, fun=median)
df.predict <- predict(m.nn, df.test, type="class")
table(df.predict)
x.nn <- subset(df.imputed, select = c("pclass","age","parch","sex","embarked"))
y.nn <- subset(df.imputed, select = "survived")
m.nn <- nnet(survived ~ pclass+age+parch+sex+embarked, df.imputed, size=4)
df.test$age <- impute(df.test$age, fun=median)
df.predict <- predict(m.nn, df.test, type="class")
table(df.predict)
write.csv(df.predict, file="predictions_tree.csv", row.names=FALSE)
class(df.predict)
df.predict <- predict(m.nn, df.test, type="response")
df.predict <- predict(m.nn, df.test, type="class")
?predict.nnet
df.predict <- predict(m.nn, df.test, type="raw")
head(df.predict)
df.predict <- round(df.predict)
table(df.predict)
write.csv(df.predict, file="predictions_tree.csv", row.names=FALSE)
q()
